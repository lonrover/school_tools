<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>总览仪表盘</title>

<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/fontawesome/css/all.min.css">

<style>
/* ======================
   仪表盘样式优化版
   ====================== */

.dashboard-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.stat-card {
  background: #fff;
  border-radius: 14px;
  padding: 22px 22px 26px;
  position: relative;
  box-shadow: 0 8px 24px rgba(0,0,0,.06);
  transition: transform .2s ease, box-shadow .2s ease;
}

.stat-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 14px 32px rgba(0,0,0,.08);
}

.stat-card::before {
  content:'';
  position:absolute;
  left:0;
  top:0;
  width:100%;
  height:5px;
  border-radius:14px 14px 0 0;
}

.stat-card.blue::before   { background:#409EFF; }
.stat-card.green::before  { background:#67C23A; }
.stat-card.orange::before { background:#E6A23C; }
.stat-card.purple::before { background:#9C27B0; }

.stat-icon {
  width:48px;
  height:48px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  color:#fff;
  margin-bottom:12px;
}

.blue   .stat-icon { background:#409EFF; }
.green  .stat-icon { background:#67C23A; }
.orange .stat-icon { background:#E6A23C; }
.purple .stat-icon { background:#9C27B0; }

.stat-value {
  font-size:36px;
  font-weight:700;
  color:#333;
  margin-bottom:4px;
}

.stat-label {
  font-size:14px;
  color:#777;
}

/* ===== 使用指南 ===== */

.guide-box {
  margin-top:30px;
  background: linear-gradient(135deg,#e3f2fd,#d9efff);
  border-radius:14px;
  padding:22px 26px;
  border-left:5px solid #409EFF;
}

.guide-box h3 {
  margin-bottom:12px;
}

.guide-box ul {
  padding-left:20px;
  line-height:1.9;
}

.guide-box li b {
  color:#333;
}

/* ===== 底部操作区 ===== */

.bottom-actions {
  margin-top:30px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:20px;
  flex-wrap:wrap;
}

.bottom-actions input {
  min-width:260px;
  padding:9px 14px;
  border-radius:20px;
  border:1px solid #ddd;
  outline:none;
}

.bottom-actions input:focus {
  border-color:#409EFF;
}
</style>
</head>

<body>

<div class="main-content">

  <div class="page-header">
    <h2><i class="fas fa-chart-pie"></i> 实验室管理总览</h2>
  </div>

  <!-- 统计卡片 -->
  <div class="dashboard-cards">

    <div class="stat-card blue">
      <div class="stat-icon"><i class="fas fa-microscope"></i></div>
      <div class="stat-value" id="assetsCount">0</div>
      <div class="stat-label">总资产数量</div>
    </div>

    <div class="stat-card green">
      <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
      <div class="stat-value" id="usageCount">0</div>
      <div class="stat-label">本月使用次数</div>
    </div>

    <div class="stat-card orange">
      <div class="stat-icon"><i class="fas fa-coins"></i></div>
      <div class="stat-value">¥<span id="consumeAmount">0</span></div>
      <div class="stat-label">本月消耗金额</div>
    </div>

    <div class="stat-card purple">
      <div class="stat-icon"><i class="fas fa-tools"></i></div>
      <div class="stat-value" id="repairCount">0</div>
      <div class="stat-label">待维修设备</div>
    </div>

  </div>

  <!-- 使用指南 -->
  <div class="guide-box">
    <h3><i class="fas fa-info-circle"></i> 系统使用指南</h3>
    <ul>
      <li><b>实验室台账</b>：所有实验资产的汇总列表</li>
      <li><b>资产明细表</b>：每件资产的详细信息</li>
      <li><b>使用记录</b>：实验课程与设备使用登记</li>
      <li><b>消耗账</b>：实验耗材的领用与库存管理</li>
      <li><b>流水账</b>：实验室经费收支记录</li>
      <li><b>使用说明</b>：系统操作说明与规范</li>
    </ul>
    <p style="margin-top:10px;color:#555">
      提示：支持 Excel 导入 / 导出，快速完成数据录入。
    </p>
  </div>

  <!-- 底部操作 -->
  <div class="bottom-actions">
    <div>
      <button class="primary"><i class="fas fa-file-export"></i> 导出全部数据</button>
      <button class="success"><i class="fas fa-database"></i> 备份数据</button>
    </div>

    <div>
      <input type="text" placeholder="搜索实验室资源…">
    </div>
  </div>

</div>

<script>
async function getData(api){
  const res = await fetch(api)
  return await res.json()
}

async function loadDashboard(){
  const assets  = await getData('/api/assets')
  const usage   = await getData('/api/usage')
  const consume = await getData('/api/consume')

  assetsCount.innerText = assets.length
  usageCount.innerText  = usage.length

  let sum = 0
  consume.forEach(r=>{
    const v = parseFloat(r[2])
    if(!isNaN(v)) sum += v
  })
  consumeAmount.innerText = sum.toFixed(0)

  repairCount.innerText = 3
}

loadDashboard()
</script>

</body>
</html>
